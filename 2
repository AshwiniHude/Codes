#include <iostream>
#include <chrono>
#include <thread>

class TokenBucket {
    double tokens, maxTokens, rate;
    std::chrono::steady_clock::time_point last;
public:
    TokenBucket(double r, double b)
        : tokens(b), maxTokens(b), rate(r), last(std::chrono::steady_clock::now()) {}

    void refill() {
        auto now = std::chrono::steady_clock::now();
        double elapsed = std::chrono::duration<double>(now - last).count();
        tokens = std::min(maxTokens, tokens + elapsed * rate);
        last = now;
    }

    bool consume() {
        refill();
        if (tokens >= 1) { tokens -= 1; return true; }
        return false;
    }
};

int main() {
    TokenBucket bucket(5, 10);
    for (int i = 0; i < 5; i++) {
        std::cout << "Request " << i << (bucket.consume() ? " allowed\n" : " denied\n");
        std::this_thread::sleep_for(std::chrono::milliseconds(200));
    }
}

